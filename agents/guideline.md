# エージェント開発ガイドライン

## Git 運用ルール

### ブランチ戦略

1. work ブランチはローカル専用

- `dev-1-work`, `dev-2-work`などの work ブランチは GitHub にプッシュしません
- 各エージェントの worktree 内でのみ使用します

2. 作業フロー

```bash
# worktree内で作業
cd ./worktrees/dev-1
git add .
git commit -m "feat: 機能実装"
# プッシュは不要！
```

3. マネージャーによるマージ

- 完了したタスクはマネージャーが dev ブランチに squash マージします
- エージェントは完了報告のみ行います

## 報告ルール

### 応答方法一覧

#### マネージャーからの指示に対する応答

| 指示タイプ          | エージェントの応答                   | 応答タイミング |
| ------------------- | ------------------------------------ | -------------- |
| `[TASK Txxx dev-n]` | タスク受領確認                       | 即座（推奨）   |
| `[CHECK]`           | `[IDLE dev-n]` または `[BUSY dev-n]` | 1 分以内       |
| `[URGENT]`          | 即座に応答                           | 30 秒以内      |
| `[重要]`            | 優先的に応答                         | 2 分以内       |

#### エージェントからの主体的な報告

1. タスク完了時

```bash
send mgr "[DONE T001 dev-1] タスク完了"
```

2. 進捗報告

```bash
send mgr "[PROGRESS T001 dev-1] 50%完了"
```

3. 問題発生時

```bash
send mgr "[FAIL T001 dev-1] エラー内容"
```

4. 質問・確認

```bash
send mgr "[ASK T001 dev-1] 仕様について確認"
```

5. ブロッカー報告

```bash
send mgr "[BLOCKED T001 dev-1] 依存タスク待ち"
```

### 報告のタイミング

- タスク受領時: 受領確認（推奨）
- 長時間タスク: 30 分ごとに進捗報告
- タスク完了時: 必須
- 問題発生時: 即座に
- ブロッカー発生時: 即座に

### 応答がない場合のエスカレーション

#### マネージャー側の対処フロー

1. レベル 1：リマインダー（5 分後）

```bash
send dev-1 "[重要] T001の状況を報告してください"
```

2. レベル 2：状態確認（10 分後）

```bash
send dev-1 "[CHECK] 応答がありません。状態を確認してください"
```

3. レベル 3：タスク再割当（15 分後）

- 他のエージェントにタスクを再割当
- またはタスクを分割/延期

#### エージェント側の心得

- マネージャーからのメッセージは常に監視
- `[CHECK]`には必ず応答
- 問題がある場合は早めに報告

## コミュニケーションマナー

1. レスポンスは迅速に

- マネージャーからの指示には速やかに応答
- 特に`[CHECK]`や`[URGENT]`には優先的に対応

2. 報告は簡潔に

- 1 行で要点をまとめる
- 詳細が必要な場合は別途ファイルに記載

3. `send` コマンドの使用

- 必ず `send mgr` を使用
- メッセージは二重引用符で囲む
- スクリプトが Enter を自動付与するため、手動では Enter 不要

4. 応答フォーマットの遵守

- `[TYPE Txxx n]` 形式を厳守
- TYPE: DONE, PROGRESS, FAIL, ASK, BLOCKED, IDLE, BUSY
- Txxx: タスク番号
- n: エージェント番号

## 作業の心構え

1. 独立性を保つ

- 自分の worktree で作業
- 他のエージェントの worktree には触れない

1. 品質を重視

- テストを実行
- コードレビューの観点で自己チェック

1. 協調性を大切に

- 他のエージェントの作業を妨げない
- 必要に応じて情報共有

## トラブルシューティング

### 応答ができない場合

1. `send` コマンドの確認

```bash
# sendコマンドが正しいパスにあるか確認
which send
# または
ls -la ./agents/bin/send
```

このガイドラインに従って、効率的で質の高い開発を進めましょう！
